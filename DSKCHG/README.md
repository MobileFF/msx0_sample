# MSX0でディスク(DSKファイル)を入れ替えるBASICプログラム <!-- omit in toc -->

## 能書き

MSX IoT BASICの`_IOTFIND()`関数や`_IOTPUT()`関数を利用して、MSX0の仮想FDDに設定されているDSKファイルを別のディスクに入れ替える（ディスクを交換する）BASICプログラムです。

実行すると、DSKファイルの一覧が表示されますので、カーソルキーを動かして入れ替えたいDSKファイルを選んでEnterを押下するとDSKファイルが指定のものに入れ替わります（ディスクが交換される）。

`_IOTPUT()`関数でDSKファイルを入れ替えると、直後１回目のディスクアクセス操作ではディスクが交換されていないような挙動になるため、プログラム内で`FILES "XXXXXXXX.XXX"`という存在しなさそうなファイル名で`FILES`コマンドを実行して、無理やり交換直後のディスクアクセスを１回発生させてからプログラムを終了させています。

自分用に作ったサンプルなので、異常系処理は何もしていません。
ファイル名以外のところでEnterしないようにしてください。

DSKファイルのファイル名は18文字以内のものに対応しています。
また、画面のスクロールなどにも対応していないため、ファイル数が50ファイルとかになると対応できません。
あくまで、サンプルコードとして御覧ください。

## 実行例

![dskchg_sample1](https://github.com/MobileFF/msx0_sample/assets/147289117/1a5395d2-f8f0-45e8-9f9e-ae7f6311da57)

## 更新履歴

2024.09.28

- DSKファイルが10個以上あるとプログラムが途中で終了する不具合を修正。
- DSKファイルはファイル名が8.3形式とは限らないため、表示するファイル名の長さを最大18文字に変更


## おことわり

上記件に関して、なにぶんにも、中の人は電子工作、電子回路については完全な素人なのでたいしてよくわかっていないことのほうが多いです。

記事の内容をお試しになる場合は、自己責任でお願いいたします。この記事にある通りのことを試してお手持ちの機器を破損しても中の人は一切の責任を負いません。

MSX0については、2024年9月時点ではかろうじて一般販売がありますが、常時安定して入手できるわけではありません。

このことに同意できない方は記事の内容を試されないようにお願いいたします。

以上
